/*! kist-fauxAnchor 0.4.0 - Simulate default anchor action. | Author: Ivan NikoliÄ‡, 2014 | License: MIT */
!function(a,b,c){function d(a,b,c){var d=k.browser.webkit.all,e=k.browser.safari.all,f=k.browser.ie.lte8,g=k.feature.touch,h=this.options.type,i=k.input.metaKey(c),j=0;return"click"===a&&(!d&&!g||f&&g)&&j++,"mousedown"===a&&((d||g&&2!==b)&&j++,f&&g&&j--),"keydown"===a&&(j++,d||13!==b||j--,"anchor"===h&&(!d&&g&&13===b&&j++,f&&g&&13===b&&j--),"button"===h&&((!d&&g&&13===b||e&&i)&&j++,(d&&13===b&&i||f&&g&&13===b)&&j--),"unfocusable"===h&&d&&13===b&&j--),(this.prevented||l.contextMenu.call(this,h,c))&&j++,Boolean(Math.max(0,j))}function e(a){var b=a.which,c=a.type,e=this.options.type;"anchor"===e&&"click"===c&&a.preventDefault(),d.call(this,c,b,a)||(this.simulateAlternative=l.simulateAlternative.call(this,e,a),this.action(l.href.call(this,e),l.target.call(this,e,a),a.target))}function f(b,c){this.element=b,this.options=a.extend({},this.defaults,{type:l.type(this.element)},c),j.setup.call(this),h.setup.call(this),i.setup.call(this)}var g={name:"fauxAnchor",ns:{css:"kist-FauxAnchor",event:".kist.fauxAnchor"},error:function(a){throw new Error(g.name+": "+a)}};g.classes={item:g.ns.css+"-item"},g.publicMethods=["destroy","prevent","unprevent"];var h={setup:function(){this.dom=this.dom||{},this.dom.el=a(this.element),this.dom.el.addClass(g.classes.item),"unfocusable"===this.options.type&&this.dom.el.attr("tabindex",0)},destroy:function(){this.dom.el.removeClass(g.classes.item),"unfocusable"===this.options.type&&this.dom.el.removeAttr("tabindex")}},i={setup:function(){this.dom.el.on("click"+this.instance.ens,a.proxy(e,this)),this.dom.el.on("mousedown"+this.instance.ens,a.proxy(e,this)),this.dom.el.on("keydown"+this.instance.ens,a.proxy(e,this))},destroy:function(){this.dom.el.off(this.instance.ens)}},j={id:0,setup:function(){this.instance=this.instance||{},this.instance.id=j.id++,this.instance.ens=g.ns.event+"."+this.instance.id},destroy:function(){delete a.data(this.element)[g.name]}},k={platform:{osx:/OS X/i.test(navigator.userAgent)},browser:{webkit:{all:"WebkitAppearance"in c.documentElement.style},safari:{all:/constructor/i.test(b.HTMLElement)},ff:{all:"MozAppearance"in c.documentElement.style},ie:{lte8:c.all&&!c.addEventListener}},feature:{touch:"Modernizr"in b&&Modernizr.touchevents||"ontouchstart"in b||"DocumentTouch"in b&&c instanceof DocumentTouch},input:{metaKey:function(a){return a.ctrlKey&&!k.platform.osx||a.metaKey}}},l={type:function(b){return b=a(b),b.is("a")?"anchor":b.is("button")||b.is('input[type="button"]')?"button":"unfocusable"},target:function(a,b){return 2===b.which||(1===b.which||13===b.which&&"anchor"!==a||13===b.which&&"anchor"===a&&!k.browser.webkit.all)&&k.input.metaKey(b)?"_blank":this.dom.el["anchor"===a?"attr":"data"]("target")||""},href:function(a){return this.dom.el["anchor"===a?"attr":"data"]("href")||""},contextMenu:function(a,b){return 3===b.which||(1===b.which||13===b.which)&&b.ctrlKey&&k.platform.osx?!0:!1},simulateAlternative:function(a,b){return"anchor"===a&&(2===b.which&&!k.browser.webkit.all||1===b.which&&b.ctrlKey&&k.browser.ie.lte8)?!1:!0}};a.extend(f.prototype,{action:function(b,c,d){var e="_blank"===c?"alternative":"basic";if(("anchor"===this.options.type||!a(d).closest("a").length)&&this.options.condition.call(this.dom.el[0])&&b)return this.options[e].call(this.dom.el[0],a.proxy(this[e],this,b))},basic:function(a){b.location.assign(a)},alternative:function(a){this.simulateAlternative&&b.open(a,"_blank")},destroy:function(){h.destroy.call(this),i.destroy.call(this),j.destroy.call(this)},prevent:function(){this.prevented=!0},unprevent:function(){this.prevented=!1},prevented:!1,defaults:{basic:function(a){a()},alternative:function(a){a()},condition:function(){return!0}}}),a.kist=a.kist||{},a.fn[g.name]=function(b){return this.each("string"==typeof b&&-1!==a.inArray(b,g.publicMethods)?function(){var c=a.data(this,g.name);c&&c[b]()}:function(){a.data(this,g.name)||a.data(this,g.name,new f(this,b))})}}(jQuery,window,document);